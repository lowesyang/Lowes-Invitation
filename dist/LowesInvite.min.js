"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),LowesInvite=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t),this.root=document.querySelector(".lowesInvite"),this.createDom(this.root.getAttribute("data-img"),this.root),this.canvas=document.querySelector(".lowesInvite>canvas"),this.context=this.canvas.getContext("2d"),this.image=document.querySelector(".lowesInvite>img"),this.image.onload=function(){e.canvas.setAttribute("width",""+e.image.offsetWidth),e.canvas.setAttribute("height",""+e.image.offsetHeight),e.originalData=e.image.src,e.width=e.image.offsetWidth,e.height=e.image.offsetHeight,e.context.font=n.fontSize+"px "+n.fontFamily,n.bold&&(e.context.font="bold "+e.context.font),e.context.textAlign="left",e.context.baseline="middle",e.setNamePos(n.x,n.y),e.setNameColor(n.color),e.init()}}return _createClass(t,[{key:"createDom",value:function(t,e){var n=document.createElement("img"),i=document.createElement("canvas");n.src=t,i.style.opacity=0,i.style.position="absolute",i.style.zIndex=-999,i.style.left=0,i.style.top=0,e.appendChild(n),e.appendChild(i)}},{key:"redraw",value:function(t){var e=this;this.image.onload=function(){e.context.drawImage(e.image,0,0,e.width,e.height),t(),e.image.onload=null},this.image.src=this.originalData}},{key:"init",value:function(){var t=this;this.redraw(function(){t.name=null,t.context.fillText("您的名字",t.signX,t.signY),t.image.src=t.canvas.toDataURL("image/png")})}},{key:"setNamePos",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.signX=t,this.signY=e}},{key:"setNameColor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"#333333";this.context.fillStyle=t}},{key:"drawName",value:function(t){var e=this;this.redraw(function(){e.name=t,e.context.fillText(t,e.signX,e.signY),e.image.src=e.canvas.toDataURL("image/png")})}},{key:"exportImg",value:function(){if(!this.name)return alert("请输入您的姓名后再下载!");var t=document.createElement("a");t.download="invitation",t.href=this.image.src;var e=document.createEvent("MouseEvents");e.initEvent("click",!0,!0),t.dispatchEvent(e)}}]),t}();